<!-- Server header with status and actions -->
<div id="gameserver-header" class="lg:flex lg:items-center lg:justify-between mb-8"
     hx-get="/gameservers/{{.Gameserver.ID}}/status"
     hx-trigger="every 2s"
     hx-target="#gameserver-header"
     hx-swap="outerHTML">
  <div class="min-w-0 flex-1">
    <div class="flex items-center space-x-3">
      {{if .Gameserver.IconPath}}
        <div class="flex-shrink-0 w-12 h-12">
          <img src="{{.Gameserver.IconPath}}" alt="{{.Gameserver.GameType}} icon" class="w-full h-full object-contain">
        </div>
      {{else}}
        <div class="flex-shrink-0 w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"></path>
          </svg>
        </div>
      {{end}}
      <div>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">{{.Gameserver.Name}}</h1>
        <div class="flex items-center space-x-3 mt-1">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium transition-smooth
            {{if eq .Gameserver.Status "running"}}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200
            {{else if eq .Gameserver.Status "stopped"}}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200
            {{else if eq .Gameserver.Status "pulling_image"}}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200
            {{else if eq .Gameserver.Status "creating_container"}}bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200
            {{else if eq .Gameserver.Status "starting_container"}}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200
            {{else if eq .Gameserver.Status "waiting_ready"}}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200
            {{else if eq .Gameserver.Status "stopping"}}bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200
            {{else if eq .Gameserver.Status "deleting"}}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200
            {{else if eq .Gameserver.Status "error"}}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200
            {{else}}bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200{{end}}">
            <div class="w-2 h-2 rounded-full mr-2
              {{if eq .Gameserver.Status "running"}}bg-green-400
              {{else if eq .Gameserver.Status "stopped"}}bg-red-400
              {{else if eq .Gameserver.Status "pulling_image"}}bg-blue-400 animate-pulse
              {{else if eq .Gameserver.Status "creating_container"}}bg-blue-400 animate-pulse
              {{else if eq .Gameserver.Status "starting_container"}}bg-yellow-400 animate-pulse
              {{else if eq .Gameserver.Status "waiting_ready"}}bg-yellow-400 animate-pulse
              {{else if eq .Gameserver.Status "stopping"}}bg-orange-400 animate-pulse
              {{else if eq .Gameserver.Status "deleting"}}bg-red-400 animate-pulse
              {{else if eq .Gameserver.Status "error"}}bg-red-400
              {{else}}bg-gray-400{{end}}"></div>
            {{if eq .Gameserver.Status "pulling_image"}}Pulling image...
            {{else if eq .Gameserver.Status "creating_container"}}Creating container...
            {{else if eq .Gameserver.Status "starting_container"}}Starting...
            {{else if eq .Gameserver.Status "waiting_ready"}}Waiting for server...
            {{else if eq .Gameserver.Status "stopping"}}Stopping...
            {{else if eq .Gameserver.Status "deleting"}}Deleting...
            {{else}}{{.Gameserver.Status}}{{end}}
          </span>
          <span class="text-sm text-gray-500 dark:text-gray-400">
            {{$gamePort := .Gameserver.GetGamePort}}
            {{if $gamePort}}
              {{if publicAddress}}
              {{.Gameserver.GameType}} • Connect: {{publicAddress}}:{{$gamePort.HostPort}}
              {{else}}
              {{.Gameserver.GameType}} • Address not configured
              {{end}}
            {{else}}
              {{.Gameserver.GameType}} • No ports configured
            {{end}}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick actions -->
  <div class="mt-5 flex lg:mt-0 lg:ml-4 space-x-3">
    <a href="/gameservers/{{.Gameserver.ID}}/edit" hx-get="/gameservers/{{.Gameserver.ID}}/edit" hx-target="#content" hx-push-url="true" class="inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-smooth">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
      </svg>
      Edit
    </a>

    {{if .Gameserver.Status.IsTransitional}}
      <!-- Disabled state during transitions - show spinner -->
      <button disabled class="inline-flex items-center px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 text-sm font-medium rounded-lg cursor-not-allowed">
        <svg class="w-4 h-4 mr-2 animate-spin" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
        </svg>
        {{if eq .Gameserver.Status "pulling_image"}}Pulling...
        {{else if eq .Gameserver.Status "creating_container"}}Creating...
        {{else if eq .Gameserver.Status "starting_container"}}Starting...
        {{else if eq .Gameserver.Status "waiting_ready"}}Initializing...
        {{else if eq .Gameserver.Status "stopping"}}Stopping...
        {{else if eq .Gameserver.Status "deleting"}}Deleting...
        {{else}}Processing...{{end}}
      </button>
    {{else if eq .Gameserver.Status "running"}}
      <button hx-post="/gameservers/{{.Gameserver.ID}}/stop" hx-target="#gameserver-header" hx-swap="outerHTML" hx-indicator="#loading"
              class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-smooth">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"></path>
        </svg>
        Stop
      </button>
      <button hx-post="/gameservers/{{.Gameserver.ID}}/restart" hx-target="#gameserver-header" hx-swap="outerHTML" hx-indicator="#loading"
              class="inline-flex items-center px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white text-sm font-medium rounded-lg transition-smooth">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg>
        Restart
      </button>
    {{else}}
      <button hx-post="/gameservers/{{.Gameserver.ID}}/start" hx-target="#gameserver-header" hx-swap="outerHTML" hx-indicator="#loading"
              class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-smooth">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-5-9V3m0 0V1m0 2h-2m2 0h2"></path>
        </svg>
        Start
      </button>
    {{end}}
  </div>
</div>
