{{ $gameserverID := .Gameserver.ID }}
{{ $currentPath := .CurrentPath }}

<div class="p-2">
    <!-- File listing -->
    {{ range .Files }}
        <div class="flex items-center justify-between hover:bg-gray-100 px-2 py-1 group">
            <div class="flex items-center space-x-2 flex-1 cursor-pointer" 
                 {{ if .IsDir }}
                    onclick="navigateTo('{{ .Path }}')"
                 {{ else }}
                    onclick="selectFile('{{ .Path }}')"
                 {{ end }}>
                <!-- File/folder icon -->
                {{ if .IsDir }}
                    <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path>
                    </svg>
                {{ else }}
                    <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                {{ end }}
                
                <!-- Name -->
                <span class="text-sm {{ if .IsDir }}font-medium{{ end }}" title="{{ .Name }}">{{ .Name }}</span>
                
                <!-- Size (for files) -->
                {{ if not .IsDir }}
                    <span class="text-xs text-gray-500">{{ formatFileSize .Size }}</span>
                {{ end }}
            </div>
            
            <!-- Actions -->
            <div class="opacity-0 group-hover:opacity-100 flex items-center space-x-1">
                {{ if not .IsDir }}
                    <button onclick="event.stopPropagation(); downloadFile('{{ .Path }}')" 
                            class="text-blue-500 hover:text-blue-700 p-1" title="Download">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                        </svg>
                    </button>
                {{ end }}
                <button onclick="event.stopPropagation(); showRenameDialog('{{ .Path }}', '{{ .Name }}')" 
                        class="text-green-500 hover:text-green-700 p-1" title="Rename">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                    </svg>
                </button>
                <button onclick="event.stopPropagation(); deleteFile('{{ .Path }}')" 
                        class="text-red-500 hover:text-red-700 p-1" title="Delete">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    {{ else }}
        <div class="text-center text-gray-500 py-4">
            <p>No files in this directory</p>
        </div>
    {{ end }}
</div>