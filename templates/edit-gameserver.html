<div class="max-w-2xl mx-auto">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold text-gray-900">Edit Gameserver</h2>
    <a href="/{{.Gameserver.ID}}" class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-md">‚Üê Back</a>
  </div>
  
  <div class="bg-white shadow rounded-lg p-6">
    <form hx-put="/{{.Gameserver.ID}}" hx-indicator="#loading" hx-swap="none">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
          <input type="text" name="name" required value="{{.Gameserver.Name}}" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Game</label>
          <select name="game_id" required class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" onchange="updatePort(this)">
            <option value="">Select a game</option>
            {{range .Games}}
              <option value="{{.ID}}" data-port="{{.DefaultPort}}" {{if eq .ID $.Gameserver.GameID}}selected{{end}}>{{.Name}}</option>
            {{end}}
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Port</label>
          <input type="number" id="port" name="port" required min="1024" max="65535" value="{{.Gameserver.Port}}" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        
        <div class="grid grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Memory (GB)</label>
            <input type="number" name="memory_gb" min="0.25" max="32" step="0.25" value="{{.Gameserver.MemoryGB}}" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">CPU Cores (0 = unlimited)</label>
            <input type="number" name="cpu_cores" min="0" max="16" step="0.5" value="{{.Gameserver.CPUCores}}" placeholder="0 for unlimited" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Max Backups (0 = unlimited)</label>
            <input type="number" name="max_backups" min="0" max="100" value="{{.Gameserver.MaxBackups}}" placeholder="7" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Environment Variables (one per line)</label>
          <textarea name="environment" rows="3" placeholder="EULA=true&#10;MAX_PLAYERS=20" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">{{range .Gameserver.Environment}}{{.}}
{{end}}</textarea>
        </div>
      </div>
      
      <div class="flex justify-between mt-6">
        <a href="/{{.Gameserver.ID}}" class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-md">Cancel</a>
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md shadow-sm">Update Gameserver</button>
      </div>
    </form>
  </div>
</div>

<div id="loading" class="htmx-indicator fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded shadow-lg">Updating...</div>

<script>
function updatePort(select) {
  const portInput = document.getElementById('port');
  const selectedOption = select.options[select.selectedIndex];
  const defaultPort = selectedOption.getAttribute('data-port');
  if (defaultPort) {
    portInput.value = defaultPort;
  }
}
</script>